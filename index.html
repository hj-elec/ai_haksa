<!DOCTYPE html>
<html lang="ko">
<head>
    <base target="_top">  /*ëª¨ë°”ì¼ì—ì„œ ì „ì²´í™”ë©´ í‘œì‹œ ì½”ë“œ */
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í˜œì „ëŒ€í•™êµ AI í•™ì‚¬ìƒë‹´</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        /* --- 1. ì „ì—­ ë³€ìˆ˜ ë° ê¸°ë³¸ ìŠ¤íƒ€ì¼ --- */
        :root {
            --background-start: #ffffff;
            --background-end: #f8fafc;
            --card-background: rgba(255, 255, 255, 0.95);
            --border-color: rgba(0, 51, 102, 0.15); 
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --accent-color: #003366; 
            --error-color: #ef4444;
            --gradient-bg: #003366;
            --card-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --soft-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gradient-bg);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            padding: 1rem;
        }

        /* --- 2. ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ --- */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: move-dots 20s linear infinite;
            z-index: -1;
        }

        @keyframes move-dots {
            from { transform: translate(0, 0); }
            to { transform: translate(50px, 50px); }
        }
        
        /* --- 3. ë ˆì´ì•„ì›ƒ ë° ì»¨í…Œì´ë„ˆ --- */
        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
        }
        
        /* â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€ëœ CSS â–¼â–¼â–¼ */
        .admin-link-container {
            width: 100%;
            text-align: right;
            margin-bottom: 0.5rem;
        }
        .admin-link-container a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }
        .admin-link-container a:hover {
            color: white;
            text-decoration: underline;
        }
        /* â–²â–²â–² CSS ì¶”ê°€ ë â–²â–²â–² */


        /* --- 4. í—¤ë” --- */
        .header {
            text-align: center;
            margin-bottom: 2rem;
            animation: fade-in-down 0.8s ease-out;
        }

        .ai-icon img {
            width: 4rem;
            height: 4rem;
            border-radius: 50%;
            box-shadow: var(--soft-shadow);
            background: white;
            padding: 0.5rem;
        }

        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            font-weight: 500;
        }

        /* --- 5. ë©”ì¸ í¼ ì¹´ë“œ --- */
        .form-card {
            background: var(--card-background);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 1.5rem;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--card-shadow);
            animation: fade-in-up 0.8s 0.2s ease-out both;
        }

        .form-section {
            margin-bottom: 2rem;
        }
        .form-section:last-child {
            margin-bottom: 0;
        }
        .form-section h3 {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.25rem;
        }
        
        /* --- 6. í¼ ìš”ì†Œ (Input, Select, Textarea) --- */
        .input-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: var(--soft-shadow);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(0, 51, 102, 0.2), var(--soft-shadow);
            transform: translateY(-1px);
        }

        .form-group select {
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M8 11.5a.5.5 0 0 1-.354-.146l-4-4a.5.5 0 0 1 .708-.708L8 10.293l3.646-3.647a.5.5 0 0 1 .708.708l-4 4A.5.5 0 0 1 8 11.5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            cursor: pointer;
            padding-right: 3rem;
        }
        
        .form-group textarea {
            min-height: 6rem;
            resize: vertical;
        }

        /* --- 7. ë¼ë””ì˜¤ ë²„íŠ¼ ê·¸ë£¹ (ìƒë‹´ ì£¼ì œ) --- */
        .radio-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .radio-item {
            position: relative;
        }

        .radio-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
            margin: 0;
        }

        .radio-item label {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0.875rem 1rem;
            background: white;
            border: 1px solid rgba(0, 51, 102, 0.2);
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            text-align: center;
            min-height: 3rem;
            margin: 0;
        }

        .radio-item input[type="radio"]:checked + label {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 51, 102, 0.3);
        }

        .radio-item label:hover {
            border-color: var(--accent-color);
            background: rgba(0, 51, 102, 0.05);
        }

        .radio-item input[type="radio"]:checked + label:hover {
            background: #002855; /* A darker shade of accent for hover */
        }
        
        /* ì‹¤ì œ ë¼ë””ì˜¤ ë²„íŠ¼ì€ í™”ë©´ì—ì„œ ìˆ¨ê¹ë‹ˆë‹¤. */
        #cat11 {
            display: none;
        }

        /* 'í•™ìƒì‹ë‹¹ ë©”ë‰´' ë¼ë²¨(ë²„íŠ¼)ì˜ ê¸°ë³¸ ìŠ¤íƒ€ì¼ì„ ì§€ì •í•©ë‹ˆë‹¤. */
        label[for="cat11"] {
            background-color: #007bff;  /* ë°°ê²½ìƒ‰ (íŒŒë€ìƒ‰ ê³„ì—´) */
            color: white;               /* ê¸€ììƒ‰ (í°ìƒ‰) */
            padding: 10px 15px;         /* ë²„íŠ¼ ë‚´ë¶€ ì—¬ë°± */
            border-radius: 5px;         /* ëª¨ì„œë¦¬ë¥¼ ë‘¥ê¸€ê²Œ */
            cursor: pointer;            /* ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ì†ê°€ë½ ëª¨ì–‘ìœ¼ë¡œ ë³€ê²½ */
            font-weight: bold;          /* ê¸€ìë¥¼ êµµê²Œ */
            transition: background-color 0.2s; /* ìƒ‰ìƒì´ ë¶€ë“œëŸ½ê²Œ ë³€í•˜ëŠ” íš¨ê³¼ */
        }

        /* ë²„íŠ¼ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ìŠ¤íƒ€ì¼ì„ ë³€ê²½í•©ë‹ˆë‹¤. */
        label[for="cat11"]:hover {
            background-color: #0056b3;  /* ë°°ê²½ìƒ‰ì„ ì¡°ê¸ˆ ë” ì–´ë‘¡ê²Œ */
        }
        
        /* â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€ëœ CSS â–¼â–¼â–¼ */
        /* 'ì œì•ˆ&ì˜¤ë¥˜ ì‚¬í•­' ë²„íŠ¼ ìˆ¨ê¹€ ë° ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        #cat12 {
            display: none;
        }
        label[for="cat12"] {
            background-color: #f43f5e; /* ë°°ê²½ìƒ‰ (íŒŒë€ìƒ‰ ê³„ì—´) */
            color: white;               /* ê¸€ììƒ‰ (í°ìƒ‰) */
            padding: 10px 15px;         /* ë²„íŠ¼ ë‚´ë¶€ ì—¬ë°± */
            border-radius: 5px;         /* ëª¨ì„œë¦¬ë¥¼ ë‘¥ê¸€ê²Œ */
            cursor: pointer;            /* ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ì†ê°€ë½ ëª¨ì–‘ìœ¼ë¡œ ë³€ê²½ */
            font-weight: bold;          /* ê¸€ìë¥¼ êµµê²Œ */
            transition: background-color 0.2s; /* ìƒ‰ìƒì´ ë¶€ë“œëŸ½ê²Œ ë³€í•˜ëŠ” íš¨ê³¼ */
        }
        label[for="cat12"]:hover {
            background-color: #0056b3; /* ë°°ê²½ìƒ‰ì„ ì¡°ê¸ˆ ë” ì–´ë‘¡ê²Œ */
        }
        /* â–²â–²â–² CSS ì¶”ê°€ ë â–²â–²â–² */


        /* --- 8. ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ íƒœê·¸ --- */
        .frequent-questions {
            margin-bottom: 1.5rem;
        }
        
        .frequent-questions h4 {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            font-weight: 500;
        }

        .question-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            min-height: 2.25rem;
            align-items: center;
        }

        .question-tag {
            background: rgba(0, 51, 102, 0.08);
            border: 1px solid rgba(0, 51, 102, 0.2);
            border-radius: 1rem;
            padding: 0.5rem 0.75rem;
            font-size: 0.8125rem;
            color: var(--accent-color);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            opacity: 0;
            transform: translateY(10px);
            animation: tag-fade-in 0.5s ease forwards;
        }

        .question-tag:hover {
            background: rgba(0, 51, 102, 0.15);
            transform: translateY(-1px);
            border-color: var(--accent-color);
        }
        
        .question-tag-placeholder {
            font-size: 0.875rem;
            color: var(--text-secondary);
            padding: 0.5rem 0.75rem;
            width: 100%;
            text-align: center;
            animation: tag-fade-in 0.5s ease forwards;
        }

        @keyframes tag-fade-in {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- 9. ì§ˆë¬¸ ì…ë ¥ ë° ë²„íŠ¼ --- */
        .char-counter {
            text-align: right;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            margin-top: 2rem;
            align-items: center;
        }
        
        .btn {
            padding: 1rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            box-shadow: var(--soft-shadow);
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
            box-shadow: 0 6px 20px -5px rgba(0, 51, 102, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px rgba(0, 51, 102, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: white;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            font-size: 0.875rem;
        }

        .btn-secondary:hover {
            background: var(--background-end);
            transform: translateY(-1px);
            color: var(--text-primary);
        }
        
        /* --- 10. ë™ì  ìƒíƒœ í‘œì‹œ (ë¡œë”©, ì—ëŸ¬, ê²°ê³¼) --- */
        #form-validation-error {
            display: none;
            color: var(--error-color);
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1.25rem;
            margin-top: -1rem;
        }
        
        .loading, .error {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 0.75rem;
        }
        
        .spinner {
            width: 1.5rem;
            height: 1.5rem;
            border: 3px solid rgba(0, 51, 102, 0.2);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading span, .error span {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .result-section {
            display: none;
            margin-top: 2rem;
            animation: fade-in-up 0.8s ease-out;
        }

        .result-card {
            background: var(--card-background);
            backdrop-filter: blur(20px);
            border-radius: 1.5rem;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--card-shadow);
        }
        
        .result-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }

        .result-icon img {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: white;
            padding: 0.5rem;
            box-shadow: var(--soft-shadow);
        }

        .result-header h3 {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .result-content {
            background: white;
            border-radius: 1rem;
            padding: 1.25rem;
            border: 1px solid var(--border-color);
            font-size: 0.9375rem;
            box-shadow: var(--soft-shadow);
            line-height: 1.7;
        }

        /* --- 11. ë””ë²„ê·¸ ë¡œê·¸ --- */
        #log-container {
            display: none;
            margin-top: 2rem;
            padding: 1.5rem;
            background: white;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--soft-shadow);
        }
        
        #log-container h3 {
            color: var(--accent-color);
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        #log-container pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'JetBrains Mono', monospace, 'Pretendard';
            font-size: 0.75rem;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        
        #languageSelect {
            width: 50%;      /* ê¸°ë³¸ ë„ˆë¹„ì˜ ì ˆë°˜ */
            min-width: 120px; /* ìµœì†Œ ë„ˆë¹„ ì§€ì • ê°€ëŠ¥ */
        }
                
        /* --- 12. ë°˜ì‘í˜• ë¯¸ë””ì–´ ì¿¼ë¦¬ --- */
        @media (min-width: 576px) {
            body { padding: 1.5rem; }
            .container { max-width: 540px; }
            .form-card, .result-card { padding: 2rem; }
            .input-row { grid-template-columns: 1fr 1fr; }
            .radio-group { grid-template-columns: repeat(2, 1fr); }
        }

        @media (min-width: 768px) {
            body { padding: 2rem; }
            .container { max-width: 720px; }
            .radio-group { grid-template-columns: repeat(3, 1fr); }
        }
        
        @media (max-width: 575px) {
            .radio-group { grid-template-columns: 1fr; gap: 0.5rem; }
        }

        @media (max-width: 480px) {
            .radio-item label { padding: 0.75rem 0.875rem; font-size: 0.8rem; min-height: 2.75rem; }
            .button-group { grid-template-columns: 1fr; gap: 0.75rem; }
        }

        /* --- 13. ì• ë‹ˆë©”ì´ì…˜ í‚¤í”„ë ˆì„ --- */
        @keyframes fade-in-down {
            from { opacity: 0; transform: translateY(-1.25rem); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(1.25rem); }
            to { opacity: 1; transform: translateY(0); }
        } 
    </style>
</head>
<body>
    <div class="container">
        <!-- â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€ëœ HTML â–¼â–¼â–¼ -->
        <div class="admin-link-container">
            <a href="#" onclick="openAdminPage(event)">ê´€ë¦¬ì</a>
        </div>
        <!-- â–²â–²â–² HTML ì¶”ê°€ ë â–²â–²â–² -->

        <header class="header">
            <h1>AI í•™ì‚¬ìƒë‹´</h1>
            <p class="subtitle">í˜œì „ëŒ€í•™êµ í•™ìƒë“¤ì„ ìœ„í•œ AI ì±—ë´‡</p>
        </header>

        <main class="form-card">
            <section class="form-section">
                <h3><span class="section-icon">ğŸ“</span>í•™ìƒ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</h3>
                <div class="input-row">
                    <div class="form-group">
                        <label for="admissionYear">ì…í•™ì—°ë„</label>
                        <input type="text" id="admissionYear" placeholder="ì˜ˆ: 2024" maxlength="4">
                    </div>
                    <div class="form-group">
                        <label for="department">í•™ê³¼</label>
                        <select id="department">
                            <option value="">í•™ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        </select>
                    </div>
                </div>
            </section>
            
            <section class="form-section">
                <h3><span class="section-icon">ğŸ·ï¸</span>ìƒë‹´ ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</h3>
                <div class="radio-group">
                    <div class="radio-item"><input type="radio" id="cat1" name="category" value="í•™ì‚¬ì¼ì •"><label for="cat1">í•™ì‚¬ì¼ì •</label></div>
                    <div class="radio-item"><input type="radio" id="cat2" name="category" value="íœ´í•™, ë³µí•™, ì „ê³¼, ì œì  ë“±"><label for="cat2">í•™ì ë³€ë™(íœ´í•™,ë³µí•™,ì „ê³¼ ë“±)</label></div>
                    <div class="radio-item"><input type="radio" id="cat3" name="category" value="ì¡¸ì—…í•™ì , ì„±ì , í•™ì "><label for="cat3">í•™ì ê´€ë ¨/ì´ ì¡¸ì—…í•™ì </label></div>
                    <div class="radio-item"><input type="radio" id="cat4" name="category" value="ì¥í•™"><label for="cat4">ì¥í•™ê´€ë ¨</label></div>
                    <div class="radio-item"><input type="radio" id="cat5" name="category" value="í˜„ì¥ì‹¤ìŠµ, ì¸í„´ì‹­"><label for="cat5">êµ­ë‚´ì™¸ í˜„ì¥ì‹¤ìŠµ/ì¸í„´ì‹­</label></div>
                    <div class="radio-item"><input type="radio" id="cat6" name="category" value="ì¶œì„, ê²°ì„"><label for="cat6">ì¶œê²°ê´€ë ¨</label></div>
                    <div class="radio-item"><input type="radio" id="cat7" name="category" value="ìˆ˜ê°•ì‹ ì²­, ì¬ìˆ˜ê°•, í•™ì ì´ìˆ˜"><label for="cat7">ìˆ˜ê°•ì‹ ì²­/ì¬ìˆ˜ê°•/í•„ìˆ˜í•™ì </label></div>
                    <div class="radio-item"><input type="radio" id="cat8" name="category" value="ë“±ë¡ê¸ˆ"><label for="cat8">ë“±ë¡ê¸ˆ</label></div>
                    <div class="radio-item"><input type="radio" id="cat9" name="category" value="ì „í™”ë²ˆí˜¸"><label for="cat9">ì—°ë½ì²˜</label></div>
                    <div class="radio-item"><input type="radio" id="cat10" name="category" value="ê¸°íƒ€"><label for="cat10">ê¸°íƒ€</label></div>
                    <div class="radio-item"><input type="radio" id="cat11" name="category" value="í•™ìƒì‹ë‹¹ ë©”ë‰´" onclick="window.open('https://www.hj.ac.kr/hj/na/ntt/selectNttList.do?mi=200000316&bbsId=1010524', '_blank');"><label for="cat11">í•™ìƒì‹ë‹¹ ë©”ë‰´(ìƒˆì°½ì—´ê¸°)</label></div>
                    
                    <div class="radio-item">
                        <input type="radio" id="cat12" name="category" value="QNA" onclick="openQnaBoard()">
                        <label for="cat12">ì œì•ˆ&ì˜¤ë¥˜ ë“±ë¡(ìƒˆì°½ì—´ê¸°)</label>
                    </div>
                </div>
            </section>
            
            <section class="form-section">
                    <h3><span class="section-icon">ğŸŒ</span>ì–¸ì–´ ì„ íƒ</h3>
                    <div class="form-group">
                        <select class="form-control" id="languageSelect">
                            <option value="ko">í•œêµ­ì–´ (Korean)</option>
                            <option value="vi">ë² íŠ¸ë‚¨ì–´ (Vietnamese)</option>
                            <option value="mn">ëª½ê³¨ì–´ (Mongolian)</option>
                            <option value="uz">ìš°ì¦ˆë² í‚¤ìŠ¤íƒ„ì–´ (Uzbek)</option>
                            <option value="ky">í‚¤ë¥´ê¸°ìŠ¤ì–´ (Kyrgyz)</option>
                            <option value="tg">íƒ€ì§€í¬ì–´ (Tajik)</option>
                            <option value="th">íƒœêµ­ì–´ (Thai)</option>
                            <option value="my">ë¯¸ì–€ë§ˆì–´ (Burmese)</option>
                            <option value="ar">ì•„ëì–´ (Arabic)</option>
                            <option value="zh">ì¤‘êµ­ì–´ (Chinese)</option>
                            <option value="zh-CN">ì¤‘êµ­ì–´(ê°„ì²´) (Chinese, Simplified)</option>
                            <option value="ru">ëŸ¬ì‹œì•„ì–´ (Russian)</option>
                            <option value="kk">ì¹´ìíì–´ (Kazakh)</option>
                        </select>
                    </div>
                </section>

                <section class="form-section">
                    <h3><span class="section-icon">âœï¸</span>ê¶ê¸ˆí•œ ë‚´ìš©ì„ ì§ˆë¬¸í•´ì£¼ì„¸ìš”</h3>
                    
                    <div class="frequent-questions">
                        <h4><span class="section-icon"></span>ìì£¼ ë¬»ëŠ” ì§ˆë¬¸â“</h4>
                        <div class="question-tags" id="questionTags">
                            </div>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="question" class="form-control" placeholder="ì˜ˆ: 2025í•™ë…„ë„ 1í•™ê¸° ë“±ë¡ê¸ˆ ë‚©ë¶€ ê¸°ê°„ì„ ì•Œë ¤ì£¼ì„¸ìš”." maxlength="500"></textarea>
                        <div class="char-counter" id="charCounter">0 / 500</div>
                    </div>
                </section>
            
            <div id="form-validation-error"></div>

            <div class="button-group">
                <button type="button" class="btn btn-primary" id="submitBtn">
                    <i class="fas fa-paper-plane"></i>
                    <span id="submitText"> AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°</span>
                </button>
                <button type="button" class="btn btn-secondary" id="resetBtn">
                    <i class="fas fa-rotate-right"></i> ì´ˆê¸°í™”
                </button>
            </div>
        </main>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <span>AIê°€ ë‹µë³€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>
        </div>
        
        <div class="error" id="error">
             <span id="errorMessage"></span>
        </div>

        <section class="result-section" id="resultSection">
            <div class="result-card">
                <div class="result-header">
                    <h3>AIì˜ ë‹µë³€</h3>
                </div>
                <div class="result-content" id="resultContent"></div>
            </div>
        </section>

        <div id="log-container">
            <h3>ë””ë²„ê·¸ ë¡œê·¸</h3>
            <pre id="log-content"></pre>
        </div>
    </div>

    <script>
        /**
         * ---------------------------------------------------------------------
         * AI í•™ì‚¬ìƒë‹´ ì›¹ ì•± ìŠ¤í¬ë¦½íŠ¸
         * ---------------------------------------------------------------------
         */

        // --- 1. DOM ìš”ì†Œ ìºì‹± ---
        const admissionYearInput = document.getElementById('admissionYear');
        const departmentSelect = document.getElementById('department');
        const questionTextarea = document.getElementById('question');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const errorMessage = document.getElementById('errorMessage');
        const resultSection = document.getElementById('resultSection');
        const resultContent = document.getElementById('resultContent');
        const charCounter = document.getElementById('charCounter');
        const submitText = document.getElementById('submitText');
        const logContainer = document.getElementById('log-container');
        const logContent = document.getElementById('log-content');
        const questionTagsContainer = document.getElementById('questionTags');
        const formValidationError = document.getElementById('form-validation-error');

        // --- 2. ë°ì´í„° ---
        const frequentQuestionsData = {
            'í•™ì‚¬ì¼ì •': ['ë‹¤ìŒ í•™ê¸° ê°œê°•ì¼ì€?', 'ì´ë²ˆ í•™ê¸° ë°©í•™ ì‹œì‘ì¼', 'ê¸°ë§ê³ ì‚¬ ê¸°ê°„ ì•Œë ¤ì¤˜'],
            'íœ´í•™, ë³µí•™, ì „ê³¼, ì œì  ë“±': ['ì¼ë°˜íœ´í•™ì€ ìµœëŒ€ ëª‡ ë²ˆ ê°€ëŠ¥í•œê°€ìš”?', 'í•™ì‚¬ê²½ê³ ë¥¼ ë°›ìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?', 'ì „ê³¼ ì‹ ì²­ ì‹œê¸°ì™€ ì¡°ê±´ ì•Œë ¤ì¤˜', 'ë³µí•™ ì‹ ì²­ ê¸°ê°„'],
            'ì¡¸ì—…í•™ì , ì„±ì , í•™ì ': ['ì¡¸ì—…í•˜ë ¤ë©´ ëª‡ í•™ì  ë“¤ì–´ì•¼ í•˜ë‚˜ìš”?', 'ì§ˆë³‘, ì‚¬ê³  ë“±ì— ì˜í•œ ì¶”ê°€ì‹œí—˜ ì‹ ì²­ë°©ë²•ì€?', 'ì„±ì í‰ê°€ ë¹„ìœ¨ê³¼ ì„±ì  ë“±ê¸‰ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?'],
            'ì¥í•™': ['ì‹ ì…ìƒì´ ë°›ì„ ìˆ˜ ìˆëŠ” ì¥í•™ê¸ˆ ì•Œë ¤ì¤˜', 'ì¬í•™ìƒ ì„±ì ìš°ìˆ˜ì¥í•™ê¸ˆ ì¢…ë¥˜ëŠ”?', 'ê°€ì¡±, í˜•ì œê°€ ê°™ì´ ë‹¤ë‹ˆë©´ ì¥í•™ê¸ˆ ìˆë‚˜ìš”?', 'í† ìµ ì˜í•˜ë©´ ì£¼ëŠ” ì¥í•™ê¸ˆ ìˆë‚˜ìš”?'],
            'í˜„ì¥ì‹¤ìŠµ, ì¸í„´ì‹­': ['í˜„ì¥ì‹¤ìŠµì€ ëª‡ í•™ë…„ë¶€í„° ì‹ ì²­ ê°€ëŠ¥í•œê°€ìš”?', 'í˜„ì¥ì‹¤ìŠµë„ ëˆ(ì‹¤ìŠµì§€ì›ë¹„)ì„ ë°›ë‚˜ìš”?', 'êµ­ì™¸(í•´ì™¸) ì¸í„´ì‹­ ì§€ì› ìê²© ì•Œë ¤ì¤˜', 'ì¸í„´ì‹­ì€ ëª‡ í•™ì  ì¸ì •ë˜ë‚˜ìš”?'],
            'ì¶œì„, ê²°ì„': ['ê²°ì„ Fí•™ì  ê¸°ì¤€', 'ê³µê²°(ì¶œì„ì¸ì •) ì‚¬ìœ ', 'ê²°ì„ í—ˆìš© ì¼ìˆ˜'],
            'ìˆ˜ê°•ì‹ ì²­, ì¬ìˆ˜ê°•, í•™ì ì´ìˆ˜': ['í•œ í•™ê¸°ì— ëª‡ í•™ì ê¹Œì§€ ì‹ ì²­ ê°€ëŠ¥í•œê°€ìš”?', 'ì¬ìˆ˜ê°• ì‹ ì²­ ì¡°ê±´', 'ìˆ˜ê°•ì‹ ì²­ ì •ì • ê¸°ê°„'],
            'ë“±ë¡ê¸ˆ': ['í•™ê³¼ë³„ ë“±ë¡ê¸ˆ', 'ë“±ë¡ê¸ˆ ë¶„í•  ë‚©ë¶€', 'ë“±ë¡ê¸ˆ í™˜ë¶ˆ ê·œì •', 'ì´ˆê³¼í•™ê¸° ë“±ë¡ê¸ˆ'],
            'ì „í™”ë²ˆí˜¸': ['êµë¬´íŒ€ ì—°ë½ì²˜', 'í•™ìƒíŒ€ ì „í™”ë²ˆí˜¸', 'í•™ê³¼ ì‚¬ë¬´ì‹¤ ë²ˆí˜¸'],
            'ê¸°íƒ€': ['ì¦ëª…ì„œ ë°œê¸‰ ë°©ë²•', 'ë„ì„œê´€ ì´ìš©ì‹œê°„']
        };

        // --- 3. ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        /**
         * ë‹¤êµ­ì–´ ì„ íƒ ë¦¬ìŠ¤íŠ¸ ë°•ìŠ¤ (ì´ ë¶€ë¶„ì€ submitQuestion í•¨ìˆ˜ë¡œ ë¡œì§ì´ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.)
         */
        // document.getElementById("submitBtn").addEventListener("click", function() { ... });

        /**
         * í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì‹¤í–‰ë˜ëŠ” ì´ˆê¸°í™” í•¨ìˆ˜
         */
        document.addEventListener('DOMContentLoaded', function() {
            addEventListeners();
            loadDepartments();
            updateFrequentQuestions(null); // ì´ˆê¸° ìƒíƒœì—ì„œëŠ” í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ
            admissionYearInput.value = new Date().getFullYear();
            admissionYearInput.focus();
        });

        /**
         * ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•˜ëŠ” í•¨ìˆ˜
         */
        function addEventListeners() {
            submitBtn.addEventListener('click', submitQuestion);
            resetBtn.addEventListener('click', resetForm);
            
            questionTextarea.addEventListener('input', function() {
                const length = this.value.length;
                charCounter.textContent = `${length} / 500`;
                charCounter.style.color = length > 450 ? 'var(--error-color)' : length > 400 ? '#f59e0b' : 'var(--text-secondary)';
            });

            admissionYearInput.addEventListener('input', function() {
                this.value = this.value.replace(/[^0-9]/g, '');
            });

            questionTextarea.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    submitQuestion();
                }
            });

            document.querySelectorAll('input[name="category"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked) {
                        updateFrequentQuestions(this.value);
                    }
                });
            });
        }
        
        // --- 4. í•µì‹¬ ê¸°ëŠ¥ í•¨ìˆ˜ ---

        /**
         * ê³ ìœ í•œ ì„¸ì…˜ IDë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.
         */
        function getSessionId() {
            let sessionId = localStorage.getItem('hyejeonAiChatSessionId');
            if (!sessionId) {
                sessionId = crypto.randomUUID();
                localStorage.setItem('hyejeonAiChatSessionId', sessionId);
            }
            return sessionId;
        }

        /**
         * ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” 'ìì£¼ ë¬»ëŠ” ì§ˆë¬¸' íƒœê·¸ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
         */
        function updateFrequentQuestions(category) {
            questionTagsContainer.innerHTML = ''; 
            if (!category || category === 'QNA') { // QNA ë²„íŠ¼ í´ë¦­ ì‹œ íƒœê·¸ ìˆ¨ê¹€
                const placeholder = document.createElement('span');
                placeholder.className = 'question-tag-placeholder';
                placeholder.innerHTML = '<span class="highlight-text">ìƒë‹´ì£¼ì œë¥¼ ì„ íƒí•˜ë©´ AIë‹µë³€ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.</span>';
                questionTagsContainer.appendChild(placeholder);
                return;
            }
            const questions = frequentQuestionsData[category] || [];
            questions.forEach((q, index) => {
                const tag = document.createElement('span');
                tag.className = 'question-tag';
                tag.textContent = q;
                tag.setAttribute('data-question', q);
                tag.style.animationDelay = `${index * 0.05}s`;
                questionTagsContainer.appendChild(tag);
            });
            addTagClickListeners();
        }

        /**
         * 'ìì£¼ ë¬»ëŠ” ì§ˆë¬¸' íƒœê·¸ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
         */
        function addTagClickListeners() {
            document.querySelectorAll('.question-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    let questionText = this.getAttribute('data-question');
                    if (questionText === 'í•™ê³¼ ì‚¬ë¬´ì‹¤ ë²ˆí˜¸') {
                        const selectedDepartment = departmentSelect.value;
                        if (selectedDepartment) {
                            questionText = `${selectedDepartment} ì‚¬ë¬´ì‹¤ ì „í™”ë²ˆí˜¸`;
                        } else {
                            alert('ë¨¼ì € í•™ê³¼ë¥¼ ì„ íƒí•˜ì‹œë©´ ë” ì •í™•í•œ ì§ˆë¬¸ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                            departmentSelect.focus();
                            return;
                        }
                    }
                    questionTextarea.value = questionText;
                    questionTextarea.dispatchEvent(new Event('input')); 
                    questionTextarea.focus();
                });
            });
        }
        
        /**
         * Google Apps Scriptë¥¼ í˜¸ì¶œí•˜ì—¬ í•™ê³¼ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
         */
        function loadDepartments() {
            google.script.run
                .withSuccessHandler(populateDepartments)
                .withFailureHandler(handleDepartmentLoadError)
                .getDepartmentList();
        }

        /**
         * í•™ê³¼ ëª©ë¡ ë¡œë“œ ì„±ê³µ ì‹œ select ì—˜ë¦¬ë¨¼íŠ¸ì— ì˜µì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
         */
        function populateDepartments(departments) {
            departmentSelect.innerHTML = '<option value="">í•™ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
            departments.forEach(dept => {
                const option = document.createElement('option');
                option.value = dept;
                option.textContent = dept;
                departmentSelect.appendChild(option);
            });
        }

        /**
         * í•™ê³¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
         */
        function handleDepartmentLoadError(err) {
            console.error('í•™ê³¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', err);
            showError('í•™ê³¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.');
        }

        /**
         * Q&A ê²Œì‹œíŒì„ ìƒˆ ì°½ìœ¼ë¡œ ì—½ë‹ˆë‹¤.
         */
        function openQnaBoard() {
            const label = document.querySelector('label[for="cat12"]');
            const originalText = label.textContent;
            label.textContent = 'ì—¬ëŠ” ì¤‘...';

            google.script.run
                .withSuccessHandler(function(baseUrl) {
                    const qnaUrl = baseUrl + '?page=qna';
                    window.open(qnaUrl, '_blank');
                    label.textContent = originalText;
                    document.getElementById('cat12').checked = false; 
                })
                .withFailureHandler(function(err) {
                    alert('ê²Œì‹œíŒ ì£¼ì†Œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    console.error('getWebAppUrl ì‹¤íŒ¨:', err);
                    label.textContent = originalText;
                })
                .getWebAppUrl();
        }
        
        /**
         * â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€ëœ JavaScript í•¨ìˆ˜ â–¼â–¼â–¼
         * ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ìƒˆ ì°½ìœ¼ë¡œ ì—½ë‹ˆë‹¤.
         */
        function openAdminPage(event) {
            event.preventDefault(); // ë§í¬ì˜ ê¸°ë³¸ ë™ì‘(í˜ì´ì§€ ì´ë™)ì„ ë§‰ìŠµë‹ˆë‹¤.
            const link = event.target;
            const originalText = link.textContent;
            link.textContent = 'ì—¬ëŠ” ì¤‘...';

            google.script.run
                .withSuccessHandler(function(baseUrl) {
                    const adminUrl = baseUrl + '?page=admin';
                    window.open(adminUrl, '_blank');
                    link.textContent = originalText;
                })
                .withFailureHandler(function(err) {
                    alert('ê´€ë¦¬ì í˜ì´ì§€ ì£¼ì†Œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    console.error('getWebAppUrl ì‹¤íŒ¨:', err);
                    link.textContent = originalText;
                })
                .getWebAppUrl();
        }
        /* â–²â–²â–² JavaScript í•¨ìˆ˜ ì¶”ê°€ ë â–²â–²â–² */

        /**
         * ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì§ˆë¬¸ì„ ì„œë²„ë¡œ ì œì¶œí•©ë‹ˆë‹¤.
         */
        function submitQuestion() {
            formValidationError.style.display = 'none';
            
            const admissionYear = admissionYearInput.value.trim();
            const department = departmentSelect.value;
            const category = document.querySelector('input[name="category"]:checked')?.value;
            const question = questionTextarea.value.trim();
            const sessionId = getSessionId();
            const selectedLang = document.getElementById("languageSelect").value;

            if (!admissionYear || !department) {
                formValidationError.textContent = 'ì…í•™ì—°ë„ì™€ í•™ê³¼ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.';
                formValidationError.style.display = 'block';
                return;
            }
            if (!category || !question) {
                formValidationError.textContent = 'ìƒë‹´ ì£¼ì œë¥¼ ì„ íƒí•˜ê³ , ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                formValidationError.style.display = 'block';
                return;
            }

            setLoadingState(true);
            hideError();
            hideResult();
            logContainer.style.display = 'none';

            google.script.run
                .withFailureHandler(handleError)
                .withSuccessHandler(handleSuccess)
                .processQuestion({ admissionYear, department, category, question, sessionId, selectedLang});
        }

        // --- 5. ì„œë²„ ì‘ë‹µ ì²˜ë¦¬ í•¨ìˆ˜ ---

        function handleSuccess(response) {
            setLoadingState(false);
            if (response.success) {
                showResult(response.answer);
            } else {
                showError(response.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
            if (response.debugLogs && Array.isArray(response.debugLogs) && response.debugLogs.length > 0) {
                logContent.textContent = response.debugLogs.join('\n\n');
                logContainer.style.display = 'block';
                logContainer.scrollIntoView({ behavior: 'smooth', block: 'end' });
            }
        }

        function handleError(err) {
            setLoadingState(false);
            console.error('Error:', err);
            showError(err.message || 'ì„œë²„ì™€ í†µì‹  ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }

        // --- 6. UI ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ ---

        function setLoadingState(isLoading) {
            loading.style.display = isLoading ? 'flex' : 'none';
            submitBtn.disabled = isLoading;
            submitText.textContent = isLoading ? 'ì²˜ë¦¬ì¤‘...' : 'AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°';
        }

        function showError(message) {
            errorMessage.textContent = message;
            error.style.display = 'flex';
        }

        function hideError() {
            error.style.display = 'none';
        }

        function showResult(answer) {
            resultContent.innerHTML = answer.replace(/\n/g, '<br>');
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }

        function hideResult() {
            resultSection.style.display = 'none';
        }

        function resetForm() {
            admissionYearInput.value = new Date().getFullYear();
            departmentSelect.value = '';
            questionTextarea.value = '';
            
            const checkedRadio = document.querySelector('input[name="category"]:checked');
            if (checkedRadio) {
                checkedRadio.checked = false;
            }
            
            charCounter.textContent = '0 / 500';
            charCounter.style.color = 'var(--text-secondary)';
            
            updateFrequentQuestions(null);
            hideError();
            hideResult();
            logContainer.style.display = 'none';
            formValidationError.style.display = 'none';
            
            admissionYearInput.focus();
        }
    </script>

</body>
</html>
